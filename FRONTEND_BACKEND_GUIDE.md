# ğŸŒ‰ å‰åç«¯æ²Ÿé€šæŒ‡å— (ç»™åˆå­¦è€…)

## ğŸ¤” å‰ç«¯å’Œåç«¯æ˜¯ä»€ä¹ˆï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ä½ åœ¨é¤å…ç‚¹é¤ï¼š

```
ğŸ‘¤ ä½  (ç”¨æˆ·)
  â†“ çœ‹èœå•ã€ç‚¹èœ
ğŸ“± å‰ç«¯ (Reactç½‘é¡µ)
  â†“ æŠŠä½ çš„ç‚¹å•ä¼ ç»™å¨æˆ¿
ğŸ”Œ API (æœåŠ¡çª—å£)
  â†“ å¨å¸ˆå¼€å§‹åšèœ
ğŸ‘¨â€ğŸ³ åç«¯ (æœåŠ¡å™¨)
  â†“ èœåšå¥½äº†
ğŸ“¦ è¿”å›ç»™å‰ç«¯æ˜¾ç¤ºç»™ä½ 
```

### ğŸ—ï¸ æˆ‘ä»¬çš„Ankié¡¹ç›®ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä½ çš„ç”µè„‘æµè§ˆå™¨                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å‰ç«¯ (Frontend)â”‚            åç«¯ (Backend)              â”‚
â”‚                 â”‚                                       â”‚
â”‚  ğŸ¨ ç”¨æˆ·ç•Œé¢     â”‚  ğŸ”§ å¤„ç†å¤æ‚é€»è¾‘                        â”‚
â”‚  - æŒ‰é’®ã€è¾“å…¥æ¡†   â”‚  - è°ƒç”¨AIç”Ÿæˆå¡ç‰‡                       â”‚
â”‚  - æ˜¾ç¤ºå¡ç‰‡åˆ—è¡¨   â”‚  - å¤„ç†å›¾ç‰‡ä¸Šä¼                          â”‚
â”‚  - ä½ çœ‹åˆ°çš„ä¸€åˆ‡   â”‚  - ç”ŸæˆAnkiæ–‡ä»¶                        â”‚
â”‚                 â”‚                                       â”‚
â”‚  Reactæ¡†æ¶       â”‚  Node.js + Expressæ¡†æ¶                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¡ å®ƒä»¬å¦‚ä½•æ²Ÿé€šï¼Ÿ

### 1. HTTPåè®® - å°±åƒè¯´è¯çš„è¯­è¨€
å‰ç«¯å’Œåç«¯ç”¨HTTPåè®®"è¯´è¯"ï¼Œå°±åƒäººä»¬ç”¨ä¸­æ–‡æˆ–è‹±æ–‡äº¤æµã€‚

### 2. APIåœ°å€ - å°±åƒé¤å…çš„æœåŠ¡çª—å£
```
http://localhost:3001/api/cards/generate
â”‚                â”‚    â”‚     â”‚      â”‚
â”‚                â”‚    â”‚     â”‚      â””â”€ å…·ä½“åŠŸèƒ½ï¼šç”Ÿæˆå¡ç‰‡
â”‚                â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœåŠ¡åˆ†ç±»ï¼šå¡ç‰‡ç›¸å…³
â”‚                â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ‰€æœ‰APIä»è¿™é‡Œå¼€å§‹
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœåŠ¡å™¨åœ°å€ï¼šlocalhostçš„3001ç«¯å£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ äº’è”ç½‘åè®®ï¼šHTTP
```

### 3. è¯·æ±‚å’Œå“åº” - å°±åƒç‚¹é¤å’Œä¸Šèœ

**ä½ ç‚¹å‡»"ç”Ÿæˆå¡ç‰‡"æ—¶å‘ç”Ÿçš„äº‹æƒ…**ï¼š

1. **å‰ç«¯å‘é€è¯·æ±‚ (ç‚¹é¤)**ï¼š
```json
{
  "question": "ä»€ä¹ˆæ˜¯Reactï¼Ÿ",
  "cardType": "basic"
}
```

2. **åç«¯å¤„ç†è¯·æ±‚ (å¨æˆ¿åšèœ)**ï¼š
   - æ¥æ”¶ä½ çš„é—®é¢˜
   - è°ƒç”¨AIç”Ÿæˆç­”æ¡ˆ
   - æ£€æŸ¥è´¨é‡
   - å‡†å¤‡å¥½å®Œæ•´çš„å¡ç‰‡

3. **åç«¯è¿”å›å“åº” (ä¸Šèœ)**ï¼š
```json
{
  "success": true,
  "data": {
    "front": "ä»€ä¹ˆæ˜¯Reactï¼Ÿ",
    "back": "Reactæ˜¯ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„JavaScriptåº“...",
    "tags": ["å‰ç«¯æ¡†æ¶"]
  }
}
```

## ğŸ“ é‡è¦æ–‡ä»¶ä»‹ç»

### å‰ç«¯æ–‡ä»¶ (ä½ çœ‹åˆ°çš„éƒ¨åˆ†)

```
frontend/src/
â”œâ”€â”€ App.tsx              # ğŸ  ä¸»åº”ç”¨ï¼Œåƒé¤å…çš„å¤§é—¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ CardForm.tsx     # ğŸ“ å¡ç‰‡åˆ›å»ºè¡¨å•ï¼Œåƒç‚¹èœå•
â”‚   â””â”€â”€ CardList.tsx     # ğŸ“‹ å¡ç‰‡åˆ—è¡¨ï¼Œåƒå·²ä¸Šèœçš„å±•ç¤ºåŒº
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.ts          # ğŸ“ å‰ç«¯çš„"ç”µè¯æœ¬"ï¼Œè®°å½•å¦‚ä½•è”ç³»åç«¯
â””â”€â”€ types/
    â””â”€â”€ index.ts        # ğŸ“‹ æ•°æ®æ ¼å¼å®šä¹‰ï¼Œåƒèœå•çš„æ ¼å¼æ ‡å‡†
```

### åç«¯æ–‡ä»¶ (ç”¨æˆ·çœ‹ä¸åˆ°çš„éƒ¨åˆ†)

```
backend/src/
â”œâ”€â”€ index.ts            # ğŸª åç«¯å…¥å£ï¼Œåƒé¤å…çš„å¤§é—¨
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ cards.ts        # ğŸ›ï¸ APIè·¯ç”±ï¼Œåƒä¸åŒçš„æœåŠ¡çª—å£
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ cardController.ts # ğŸ‘¨â€ğŸ³ å¡ç‰‡æ§åˆ¶å™¨ï¼Œåƒå¨å¸ˆé•¿
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ LLMService.ts   # ğŸ¤– AIæœåŠ¡ï¼Œåƒç‚’èœæœºå™¨äºº
â”‚   â””â”€â”€ AnkiService.ts  # ğŸ“¦ æ–‡ä»¶ç”ŸæˆæœåŠ¡ï¼Œåƒæ‰“åŒ…å‘˜
â””â”€â”€ middleware/         # ğŸ”’ å®‰å…¨æ£€æŸ¥ï¼Œåƒé—¨å«
```

## ğŸ” å®é™…å·¥ä½œæµç¨‹

### åœºæ™¯ï¼šç”¨æˆ·ç‚¹å‡»"ç”Ÿæˆå¡ç‰‡"æŒ‰é’®

1. **ç”¨æˆ·æ“ä½œ**ï¼š
   - åœ¨è¾“å…¥æ¡†è¾“å…¥é—®é¢˜ï¼š"ä»€ä¹ˆæ˜¯Reactï¼Ÿ"
   - ç‚¹å‡»"ç”Ÿæˆå¡ç‰‡"æŒ‰é’®

2. **å‰ç«¯å¤„ç† (CardForm.tsx)**ï¼š
```typescript
const handleSubmit = async (data) => {
  setLoading(true); // æ˜¾ç¤º"æ­£åœ¨ç”Ÿæˆ..."

  // æ‰“ç”µè¯ç»™åç«¯
  const response = await apiService.generateCard(data);

  if (response.success) {
    // æŠŠæ–°ç”Ÿæˆçš„å¡ç‰‡æ·»åŠ åˆ°åˆ—è¡¨
    setCards(prev => [...prev, response.data]);
  }

  setLoading(false);
};
```

3. **APIè°ƒç”¨ (api.ts)**ï¼š
```typescript
// è¿™æ˜¯å®é™…çš„"æ‰“ç”µè¯"è¿‡ç¨‹
export const generateCard = async (data) => {
  const response = await api.post('/api/cards/generate', data);
  return response.data;
};
```

4. **ç½‘ç»œä¼ è¾“**ï¼š
```
POST http://localhost:3001/api/cards/generate
è¯·æ±‚å¤´: Content-Type: application/json
è¯·æ±‚ä½“: {"question": "ä»€ä¹ˆæ˜¯Reactï¼Ÿ", "cardType": "basic"}
```

5. **åç«¯å¤„ç† (cardController.ts)**ï¼š
```typescript
export const generateCard = async (req, res) => {
  try {
    // æ¥æ”¶å‰ç«¯çš„é—®é¢˜
    const { question, cardType } = req.body;

    // è°ƒç”¨AIç”Ÿæˆç­”æ¡ˆ
    const card = await llmService.generateCard(question, cardType);

    // è´¨é‡æ£€æŸ¥
    const qualityCheck = await qualityService.check(card);

    // è¿”å›ç»“æœç»™å‰ç«¯
    res.json({ success: true, data: { ...card, qualityCheck } });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};
```

6. **ç»“æœæ˜¾ç¤º**ï¼š
- å‰ç«¯æ”¶åˆ°å“åº”
- æ›´æ–°å¡ç‰‡åˆ—è¡¨
- ç”¨æˆ·çœ‹åˆ°æ–°ç”Ÿæˆçš„å¡ç‰‡

## âš¡ å…³é”®æ¦‚å¿µè§£é‡Š

### 1. å¼‚æ­¥ç¼–ç¨‹ - "ä¸ç­‰å¾…çš„æ™ºæ…§"
```typescript
// âŒ å¦‚æœè¿™æ ·å†™ï¼Œç½‘é¡µä¼šå¡æ­»ç­‰å¾…åç«¯å“åº”
const result = backend.generateCard(); // ç­‰å¾…...
showResult(result);

// âœ… å¼‚æ­¥å†™æ³•ï¼Œç½‘é¡µä¸ä¼šå¡æ­»
const generateCard = async () => {
  showLoading("æ­£åœ¨ç”Ÿæˆ...");
  const result = await backend.generateCard(); // ä¸å¡ä½ç•Œé¢
  hideLoading();
  showResult(result);
};
```

### 2. é”™è¯¯å¤„ç† - "èœå“æœ‰é—®é¢˜æ€ä¹ˆåŠï¼Ÿ"
```typescript
try {
  const result = await apiService.generateCard(data);
  // èœå“åšå¥½äº†ï¼Œäº«ç”¨ï¼
} catch (error) {
  // èœå“æœ‰é—®é¢˜ï¼Œå‘Šè¯‰ç”¨æˆ·
  alert('ç”Ÿæˆå¤±è´¥ï¼š' + error.message);
}
```

### 3. çŠ¶æ€ç®¡ç† - "è®°ä½å·²ç‚¹èœå“"
```typescript
const [cards, setCards] = useState([]); // è®°ä½æ‰€æœ‰å¡ç‰‡

// æ·»åŠ æ–°å¡ç‰‡
setCards(prev => [...prev, newCard]);

// åˆ é™¤å¡ç‰‡
setCards(prev => prev.filter(card => card.id !== id));
```

## ğŸ› ï¸ å¦‚ä½•è°ƒè¯•å’Œæµ‹è¯•

### 1. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
1. æ‰“å¼€æµè§ˆå™¨ (Chrome/Firefox)
2. æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
3. ç‚¹å‡»"Network"æ ‡ç­¾
4. åœ¨ç½‘é¡µä¸Šæ“ä½œï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰å‰åç«¯å¯¹è¯

### 2. æŸ¥çœ‹åç«¯æ—¥å¿—
```bash
# å¯åŠ¨åç«¯æ—¶ï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºè¯·æ±‚æ—¥å¿—
POST /api/cards/generate - IP: ::1    # æ”¶åˆ°è¯·æ±‚
Response 200 - 156ms                 # å‘é€å“åº”
```

### 3. å¸¸è§é—®é¢˜
- **CORSé”™è¯¯**: å‰ç«¯åŸŸåä¸è¢«å…è®¸è®¿é—®åç«¯
- **404é”™è¯¯**: APIåœ°å€å†™é”™äº†
- **500é”™è¯¯**: åç«¯ä»£ç å‡ºé”™
- **è¶…æ—¶é”™è¯¯**: åç«¯å¤„ç†æ—¶é—´å¤ªé•¿

## ğŸ’¡ ç»™åˆå­¦è€…çš„å»ºè®®

### 1. ä»ç®€å•å¼€å§‹
- å…ˆç†è§£GET(è·å–)å’ŒPOST(åˆ›å»º)çš„åŸºæœ¬æ¦‚å¿µ
- å­¦ä¼šçœ‹Networké¢æ¿çš„ç½‘ç»œè¯·æ±‚
- ç†è§£async/awaitçš„åŸºæœ¬ç”¨æ³•

### 2. å®è·µç»ƒä¹ 
```javascript
// è¯•ç€è°ƒç”¨ä¸€ä¸‹å¥åº·æ£€æŸ¥æ¥å£
const checkHealth = async () => {
  try {
    const response = await fetch('http://localhost:3001/api/cards/health');
    const data = await response.json();
    console.log('åç«¯çŠ¶æ€:', data);
  } catch (error) {
    console.error('è¿æ¥å¤±è´¥:', error);
  }
};
```

### 3. ç†è§£æ•°æ®æµ
1. ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯å¤„ç†
2. å‰ç«¯ â†’ HTTPè¯·æ±‚ â†’ åç«¯
3. åç«¯ â†’ å¤„ç†ä¸šåŠ¡é€»è¾‘
4. åç«¯ â†’ HTTPå“åº” â†’ å‰ç«¯
5. å‰ç«¯ â†’ æ›´æ–°ç•Œé¢æ˜¾ç¤º

### 4. å­¦ä¹ èµ„æº
- [MDN Webå¼€å‘æ•™ç¨‹](https://developer.mozilla.org/zh-CN/docs/Learn)
- [JavaScriptå¼‚æ­¥ç¼–ç¨‹æŒ‡å—](https://javascript.info/async)
- [Reactå®˜æ–¹æ•™ç¨‹](https://zh-hans.react.dev/learn)

## ğŸ“ æ€»ç»“

å‰åç«¯æ²Ÿé€šå°±åƒé¤å…çš„ç‚¹é¤ç³»ç»Ÿï¼š
- **å‰ç«¯** = æœåŠ¡å‘˜å’Œèœå•
- **åç«¯** = å¨æˆ¿å’Œå¨å¸ˆ
- **API** = ç‚¹é¤å’Œä¸Šèœçš„æµç¨‹
- **HTTP** = æœåŠ¡å‘˜å’Œå¨å¸ˆçš„æ²Ÿé€šè¯­è¨€
- **JSON** = æ ‡å‡†çš„ç‚¹èœå•æ ¼å¼

ç†è§£äº†è¿™ä¸ªæ¯”å–»ï¼Œä½ å°±æŒæ¡äº†å‰åç«¯é€šä¿¡çš„æ ¸å¿ƒæ¦‚å¿µï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2025-12-09
**ç»´æŠ¤è€…**: Anki Card Generator Team